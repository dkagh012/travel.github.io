<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Your Web Page</title>
    <!-- daterangepicker CSS 파일 포함 -->
    <link
      rel="stylesheet"
      type="text/css"
      href="assets/css/daterangepicker.css"
    />
    <!-- <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css"
    /> -->
    <script type="text/javascript" src="assets/js/jquery.min.js"></script>
    <script type="text/javascript" src="assets/js/moment.min.js"></script>
    <!-- daterangepicker 한국어 locale 파일 포함 -->
    <link rel="stylesheet" href="assets/css/xeicon.min.css" />
    <link rel="stylesheet" href="assets/css/style.css" />
  </head>
  <body>
    <!-- daterangepicker를 위한 input 요소 -->
    <button type="button" class="date-modal-Open">열기</button>
    <div class="date-modal">
      <div class="date-modal-background"></div>
      <div class="date-modal-main">
        <div class="date-modal-Box">
          <div class="date-modal-header">
            <button type="button" class="modal-date-Close">닫기</button>
          </div>
          <div class="modal-date-body">
            <div class="date-modal-title">
              <h2>일정이 어떻게 되세요</h2>
            </div>
            <div class="date-modal-subtitle">
              <p>출발일 선택</p>
              <span>(최대 14일까지 선택 가능합니다.)</span>
            </div>
            <input type="text" id="dateRangePicker" / style="display:none;">
            <div class="calendar-tableBox"></div>
            <div class="date-modal-btn">
              <button
                class="buttonStyle"
                type="button"
                onClick="fnResetSearchCalendar()"
              >
                날짜 초기화 <i class="xi-catched"></i>
              </button>
              <button class="buttonStyle datebtn_balck" type="button">
                일정으로 검색
              </button>
              <button class="buttonStyle datebtn_balck" type="button">
                지역과 함께 검색
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Your other scripts and resources -->
    <script
      type="text/javascript"
      src="assets/js/daterangepicker.min.js"
    ></script>

    <script>
      function fnResetSearchCalendar() {
        $("#dateRangePicker").daterangepicker("destroy");
        $("#dateRangePicker").val("");
        fnSetSearchCalendar();
      }
      function fnSetSearchCalendar() {
        // Assuming minDate is defined somewhere in your project
        const minDate = moment().startOf("day");

        $("#dateRangePicker").daterangepicker(
          {
            parentEl: "#inline-calendar",
            alwaysShowCalendars: true,
            autoApply: true,
            inline: true,
            minDate: minDate,
            startDate: minDate,
            endDate: minDate,
            locale: {
              separator: "~",
            },
          },
          function (start, end, label, state) {
            let startDate = moment(start.format("YYYY-MM-DD"));
            let endDate = moment(end.format("YYYY-MM-DD"));

            let diff = endDate.diff(startDate, "days");
            if (diff > 14) {
              let msg = "최대 14일까지 선택 가능합니다.";
              _Popup.openDefaultPopup(msg);
              $("#btnModalConfirm").on("click", function () {
                fnResetSearchCalendar();
              });
            }

            $("#searchModalCalendarSelectFlag").val("Y");
          }
        );
      }
      // 웹 페이지 로드 후 실행되는 스크립트
      document.addEventListener("DOMContentLoaded", function () {
        // dateRangePicker 요소를 선택하고, daterangepicker를 초기화합니다.
        $("#dateRangePicker").daterangepicker({
          alwaysShowCalendars: true,
          autoApply: true,
          inline: true,
          singleDatePicker: "false" == "true" ? true : false,
          locale: {
            format: "YYYY년 MM월 DD일",
            separator: " - ",
            applyLabel: "선택",
            cancelLabel: "취소",
            fromLabel: "부터",
            toLabel: "까지",
            customRangeLabel: "직접 선택",
            weekLabel: "주",
            daysOfWeek: ["일", "월", "화", "수", "목", "금", "토"],
            monthNames: [
              "1.",
              "2.",
              "3.",
              "4.",
              "5.",
              "6.",
              "7.",
              "8.",
              "9.",
              "10.",
              "11.",
              "12.",
            ],
            firstDay: 0,
          },
          // Append the dateRangePicker calendar to the ".calendar-tableBox" div
          parentEl: ".calendar-tableBox",
        });

        // "일정 선택" 버튼 클릭 시 date-modal 열기
        document
          .querySelector(".date-modal-Open")
          .addEventListener("click", function () {
            $(".date-modal").show(); // date-modal 보이도록 show() 메서드를 호출합니다.
            $("#dateRangePicker").data("daterangepicker").show(); // dateRangePicker 캘린더도 보이도록 show() 메서드를 호출합니다.
          });

        // "닫기" 버튼 클릭 시 date-modal 닫기
        document
          .querySelector(".modal-date-Close")
          .addEventListener("click", function () {
            $(".date-modal").hide(); // date-modal 감추도록 hide() 메서드를 호출합니다.
            $("#dateRangePicker").data("daterangepicker").hide(); // dateRangePicker 캘린더도 감추도록 hide() 메서드를 호출합니다.
          });
      });
    </script>
  </body>
</html>
